# ğŸ”§ ç½‘ç»œé—®é¢˜ä¿®å¤å®Œæˆ

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### é—®é¢˜æ ¹æº
Release æ„å»ºæ—¶ `usesCleartextTraffic` è¢«è®¾ç½®ä¸º `false`,å¯¼è‡´ Android ç³»ç»Ÿé˜»æ­¢æ‰€æœ‰ HTTP è¯·æ±‚ã€‚

### ä¿®å¤å†…å®¹

1. **âœ… ä¿®æ”¹äº† `android/app/build.gradle`**
   ```gradle
   release {
       manifestPlaceholders = [usesCleartextTraffic: "true"]  // æ”¹ä¸º true
   }
   ```

2. **âœ… å¢å¼ºäº†æ—¥å¿—ç³»ç»Ÿ** (`src/api/config.ts`)
   - æ‰€æœ‰ç¯å¢ƒéƒ½ä¼šæ‰“å°ç½‘ç»œæ—¥å¿—
   - è¯¦ç»†çš„é”™è¯¯è¯Šæ–­ä¿¡æ¯
   - å¯åŠ¨æ—¶æ˜¾ç¤ºç¯å¢ƒå’Œ API åœ°å€

3. **âœ… æ·»åŠ äº†å†…ç½®è°ƒè¯•å™¨** (`NetworkDebugger`)
   - ç‚¹å‡»å³ä¸‹è§’ ğŸ› æŸ¥çœ‹å®æ—¶æ—¥å¿—
   - æ˜¾ç¤ºå½“å‰ç¯å¢ƒå’Œ API åœ°å€
   - æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œè¯·æ±‚

## ğŸš€ ç«‹å³é‡æ–°æ‰“åŒ…

è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°æ‰“åŒ…:

```bash
./build-release.sh
```

æˆ–è€…æ‰‹åŠ¨:
```bash
npm run build:android:clean
npm run build:android
```

## ğŸ“± æµ‹è¯•æ–°ç‰ˆæœ¬

1. **å®‰è£…æ–° APK**
   ```bash
   adb install -r android/app/build/outputs/apk/release/app-release.apk
   ```

2. **æ‰“å¼€åº”ç”¨,ç‚¹å‡»å³ä¸‹è§’ ğŸ› å›¾æ ‡**
   
   åº”è¯¥çœ‹åˆ°:
   ```
   ç¯å¢ƒ: ç”Ÿäº§ç¯å¢ƒ
   API åœ°å€: http://47.114.96.56:9432
   ```

3. **å°è¯•ç™»å½•/æ³¨å†Œ**
   
   ç°åœ¨åº”è¯¥èƒ½æ­£å¸¸è¿æ¥æœåŠ¡å™¨äº†!

## ğŸ” éªŒè¯ä¿®å¤

### ä½¿ç”¨å†…ç½®è°ƒè¯•å™¨
1. æ‰“å¼€ APK
2. ç‚¹å‡»å³ä¸‹è§’ ğŸ›
3. æŸ¥çœ‹ç¯å¢ƒä¿¡æ¯
4. å°è¯•ç™»å½•,æŸ¥çœ‹ç½‘ç»œè¯·æ±‚æ—¥å¿—

### ä½¿ç”¨ adb logcat
```bash
# æ¸…ç©ºæ—¥å¿—
adb logcat -c

# æŸ¥çœ‹æ—¥å¿—
adb logcat | grep "LedgerAI"
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡º:
```
[LedgerAI] ======================
[LedgerAI] Environment: PRODUCTION
[LedgerAI] API Base URL: http://47.114.96.56:9432
[LedgerAI] ======================
[LedgerAI] ğŸ“¤ Request: POST /api/auth/login
[LedgerAI] ğŸ“¤ Full URL: http://47.114.96.56:9432/api/auth/login
[LedgerAI] ğŸ“¥ Response: 200 /api/auth/login
[LedgerAI] âœ… Success: Login successful
```

## âš ï¸ å®‰å…¨æé†’

å½“å‰é…ç½®å…è®¸ HTTP æ˜æ–‡æµé‡ç”¨äºæµ‹è¯•ã€‚**æ­£å¼ä¸Šçº¿å‰åº”è¯¥:**

1. **æœåŠ¡å™¨é…ç½® HTTPS**
2. **è·å– SSL è¯ä¹¦** (Let's Encrypt å…è´¹)
3. **ä¿®æ”¹ API åœ°å€ä¸º HTTPS**
   ```typescript
   const PROD_API_URL = 'https://47.114.96.56:9432';
   ```
4. **ç¦ç”¨æ˜æ–‡æµé‡**
   ```gradle
   manifestPlaceholders = [usesCleartextTraffic: "false"]
   ```

## ğŸ“‹ æµ‹è¯•æ¸…å•

- [ ] é‡æ–°æ‰“åŒ… APK
- [ ] å®‰è£…åˆ°æµ‹è¯•æ‰‹æœº
- [ ] æ‰“å¼€å†…ç½®è°ƒè¯•å™¨æŸ¥çœ‹ç¯å¢ƒ
- [ ] å°è¯•ç™»å½•
- [ ] æŸ¥çœ‹ç½‘ç»œè¯·æ±‚æ—¥å¿—
- [ ] ç¡®è®¤èƒ½æ­£å¸¸ä½¿ç”¨

## ğŸ‰ é¢„æœŸç»“æœ

ä¿®å¤ååº”è¯¥èƒ½:
- âœ… æ­£å¸¸è¿æ¥æœåŠ¡å™¨
- âœ… ç™»å½•/æ³¨å†ŒæˆåŠŸ
- âœ… æŸ¥çœ‹å®æ—¶æ—¥å¿—
- âœ… æ‰€æœ‰ API è¯·æ±‚æ­£å¸¸

---

**ç°åœ¨é‡æ–°æ‰“åŒ…è¯•è¯•!**

```bash
./build-release.sh
```
